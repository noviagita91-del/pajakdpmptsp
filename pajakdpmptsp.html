<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pajak Kendaraan DPMPTSP Blora</title>
<style>
body{font-family:Arial,sans-serif;background:#f4f6f8;padding:20px}
h2{text-align:center}
form,table{background:#fff;padding:15px;border-radius:8px;margin-bottom:20px}
input,button{padding:8px;margin:5px 0;width:100%}
button{background:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer}
button:hover{background:#0056b3}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ddd;padding:8px;text-align:center}
th{background:#007bff;color:#fff}
.aman{color:green;font-weight:bold}
.warning{color:orange;font-weight:bold}
.danger{color:red;font-weight:bold}
.readonly{opacity:.6}
</style>
</head>
<body>

<h2>Pajak Kendaraan DPMPTSP Blora</h2>

<button onclick="loginAdmin()">Login Admin</button>
<p id="status"><b>Mode:</b> Viewer</p>

<form id="form" class="readonly">
<input id="nopol" placeholder="Nomor Polisi" disabled required>
<input id="kendaraan" placeholder="Nama Kendaraan" disabled required>
<input type="date" id="tempo" disabled required>
<button disabled>Simpan</button>
</form>

<table>
<thead>
<tr>
<th>No</th><th>No Polisi</th><th>Kendaraan</th>
<th>Jatuh Tempo</th><th>Sisa Hari</th><th>Status</th>
</tr>
</thead>
<tbody id="data"></tbody>
</table>

<script>
const PASS="admin123";
let admin=false;
let db=JSON.parse(localStorage.getItem("pajak"))||[];

function loginAdmin(){
 const p=prompt("Password Admin:");
 if(p===PASS){
  admin=true;
  status.innerHTML="<b>Mode:</b> Admin";
  document.querySelectorAll("input,button").forEach(e=>e.disabled=false);
  form.classList.remove("readonly");
 }
}

function sisaHari(t){
 return Math.ceil((new Date(t)-new Date())/86400000);
}

function tampil(){
 data.innerHTML="";
 db.forEach((x,i)=>{
  let s=sisaHari(x.tempo),st="Aman",c="aman";
  if(s<=30&&s>=0){st="Hampir Jatuh Tempo";c="warning";}
  if(s<0){st="Terlambat";c="danger";}
  data.innerHTML+=`
  <tr>
   <td>${i+1}</td><td>${x.nopol}</td><td>${x.kendaraan}</td>
   <td>${x.tempo}</td><td>${s}</td><td class="${c}">${st}</td>
  </tr>`;
 });
}

form.onsubmit=e=>{
 e.preventDefault();
 if(!admin)return;
 db.push({nopol:nopol.value,kendaraan:kendaraan.value,tempo:tempo.value});
 localStorage.setItem("pajak",JSON.stringify(db));
 form.reset();tampil();
};

tampil();
</script>

</body>
</html>
